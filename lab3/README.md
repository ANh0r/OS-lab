# linux 设备驱动程序开发

## 设计目的

Linux 驱动程序占了内核代码的一半以上，开发设计驱动程序是 linux 内核编程的一项很重要的工作。通过本次实验，学习者应了解 linux 的设备管理机制及驱动程序的组织结构；掌握 linux 设备驱动程序的编写流程及加载方法，为从事具体的硬件设备驱动程序开发打下基础。

## 内容要求

* 编写一个字符设备驱动程序，要求实现对该字符设备的打开、读、写、I/O 控制和关闭 5 个基本操作。为了避免牵涉到汇编语言，这个字符设备并非一个真实的字符设备，而是用一段内存空间来模拟的。以模块方式加载该驱动程序。
* 编写一个应用程序，测试（1）中实现的驱动程序的正确性。
* 有兴趣的同学还可以编写一个块设备的驱动程序。
* 请根据自身情况，进一步阅读分析程序中用到的相关内核函数的源码实现。

## 注意事项

* 涉及的数据结构：
    * struct cdev
    * struct char_device_struct
    * file_operations
    * file
    * inode
* 初始化流程:
    * 分配设备号
    * 定义 cdev 结构并初始化
    * 注册 cdev 结构
* 实现字符设备驱动程序的操作函数
    * 实现 file_operations 结构中要用到的函数
    * 添加 file_operations 成员
* 注销设备
    * 撤销 cdev 结构
    * 释放设备号